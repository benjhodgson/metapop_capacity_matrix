---
title: "Experimental Design"
output: 
  html_document: 
    toc: true
    toc_float: true
    keep_md: true
    number_sections: true
date: "2025-04-24"
---
Return to Model README: [README](https://github.com/benjhodgson/metapop_capacity_matrix/blob/main/README.md)

# Exploring Metapopulation Capacity
Source Code: [Exploring Metapopulation Capacity Code](https://github.com/benjhodgson/metapop_capacity_matrix/blob/main/Source%20Code/Source_Code_Index.md#Exploring-Metapopulation-Capacity)

Before considering the effects of matrix quality, it is important to understand how metapopulation capacity changes with landscape structure. That is, how do habitat cover and habitat configuration independently, and interactively, affect metapopulation capacity.

## The independent effects of habitat cover on metapopulation capacity

To investigate the effect of habitat cover independently from the distance between habitat patches, I first generate three hypothetical landscapes with equally distanced habitat patches. This landscape has a resolution of 100 x 100 units and the landscapes have either 2, 5, or 10 habitat patches:

```{r area_landscapes, echo=FALSE, dpi = 300, message=FALSE, warning=FALSE}


rm(list = ls())

library(tidyverse)
library(patchwork)


# Generate and Plot Habitat Patches ---------------------------------------


# Define 10 equally spaced habitat patches
points_10 <- data.frame(
  x = seq(0, 100, length.out = 10),
  y = seq(0, 100, length.out = 10)
)

# Define 5 equally spaced habitat patches
points_5 <- data.frame(
  x = seq(0, 100, length.out = 5),
  y = seq(0, 100, length.out = 5)
)

# Define 2 equally spaced habitat patches
points_2 <- data.frame(
  x = seq(0, 100, length.out = 2),
  y = seq(0, 100, length.out = 2)
)

# Plot the grid and points
p1 <- ggplot() +
  geom_point(data = points_10, aes(x = x, y = y), color = "darkgreen", size = 5) +
  coord_fixed() +
  theme_minimal() +
  labs(title = "10 Habitat Patches") +
  theme(
    panel.grid.minor = element_blank()
  )

p2 <- ggplot() +
  geom_point(data = points_5, aes(x = x, y = y), color = "darkgreen", size = 5) +
  coord_fixed() +
  theme_minimal() +
  labs(title = "5 Habitat Patches") +
  theme(
    panel.grid.minor = element_blank()
  )

p3 <- ggplot() +
  geom_point(data = points_2, aes(x = x, y = y), color = "darkgreen", size = 5) +
  coord_fixed() +
  theme_minimal() +
  labs(title = "2 Habitat Patches") +
theme(
  panel.grid.minor = element_blank()
)

p3 + p2 + p1


```

The metapopulation capacity is then calculated for each of the three arrangements for landscapes as the area of each habitat patch increases from 1 to 500. The distances between each habitat patch remains constant, despite the area of the habitat patches increasing. Alpha was set at 0.05, which equates to a mean dispersal distance of 20 units.

Results: [The independent effects of habitat cover on metapopulation capacity Results](https://github.com/benjhodgson/metapop_capacity_matrix/blob/main/Results/Results.md#the-independent-effects-of-habitat-cover-on-metapopulation-capacity)


## The independent effects of inter-patch distance on metapopulation capacity 

To investigate the effect of the mean distance between habitat patches on metapopulation, I again create three landscapes with 2, 5, and 10 habitat patches. Each of these habitat patches has an area of 100 units and alpha is set to 0.05.

```{r distance_landscapes, echo=FALSE, dpi = 300, message=FALSE, warning=FALSE}


rm(list = ls())

library(tidyverse)
library(patchwork)


# Generate and Plot Habitat Patches ---------------------------------------


# Define 10 equally spaced habitat patches
points_10 <- data.frame(
  x = seq(0, 100, length.out = 10),
  y = seq(0, 100, length.out = 10)
)

# Define 5 equally spaced habitat patches
points_5 <- data.frame(
  x = seq(0, 100, length.out = 5),
  y = seq(0, 100, length.out = 5)
)

# Define 2 equally spaced habitat patches
points_2 <- data.frame(
  x = seq(0, 100, length.out = 2),
  y = seq(0, 100, length.out = 2)
)

# Plot the grid and points
p1 <- ggplot() +
  geom_point(data = points_10, aes(x = x, y = y), color = "darkgreen", size = 5) +
  coord_fixed() +
  theme_minimal() +
  labs(title = "10 Habitat Patches") +
  theme(
    panel.grid.minor = element_blank()
  )

p2 <- ggplot() +
  geom_point(data = points_5, aes(x = x, y = y), color = "darkgreen", size = 5) +
  coord_fixed() +
  theme_minimal() +
  labs(title = "5 Habitat Patches") +
  theme(
    panel.grid.minor = element_blank()
  )

p3 <- ggplot() +
  geom_point(data = points_2, aes(x = x, y = y), color = "darkgreen", size = 5) +
  coord_fixed() +
  theme_minimal() +
  labs(title = "2 Habitat Patches") +
  theme(
    panel.grid.minor = element_blank()
  )

p3 + p2 + p1

```

The distance matrix is calculated, however this is then multiplied by a scaling factor between 1 and 5 and the metapopulation capacity is calculated.

Results: [The independent effects of inter-patch distance on metapopulation capacity Results](https://github.com/benjhodgson/metapop_capacity_matrix/blob/main/Results/Results.md#the-independent-effects-of-inter-patch-distance-on-metapopulation-capacity)


## The effects of habitat configuration on mean inter-patch distance

The level of spatial aggregation of habitat patches (habitat configuration) will affect the mean inter-patch distance between habitat patches. To explore this relationship, random landscapes with varying values of p will be generated and the edge density (a measure of spatial aggregation), inter-patch distances will be recorded. 

Landscapes will be 100 x 100 with a set habitat proportion of 0.15.

p values, which dictate the level of spatial aggregation will be 0.01, 0.1, 0.2, 0.4.

An example of each of these landscapes can be seen here:

There will be 100 unique landscapes for each p value.

## The effects of habitat cover on mean inter-patch distance

Habitat area will rarely change without also affecting the nearest distance between patches. Increasing the habitat cover, therefore will likely indirectly affect metapopulation capacity by decreasing the mean inter-patch distance between habitat patches. To explore the effect of habitat cover on  



